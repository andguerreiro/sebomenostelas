<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="description" content="Sebo Menos Telas – Um convite à leitura impressa, longe das telas. Desde 2017, incentivando o toque do papel e o silêncio das páginas, com atendimento humano e cuidadoso." />
  <meta name="robots" content="index, follow" />
  <meta name="author" content="Sebo Menos Telas" />
  <link rel="canonical" href="https://sebomenostelas.com.br/acervo" />
  <title>Acervo - Sebo Menos Telas</title>
  <link rel="icon" href="logo.png" type="image/png" />

  <style>
    :root {
      color-scheme: light dark;
    }

    body {
      max-width: 960px;
      margin: 40px auto;
      font-family: Georgia, serif;
      font-size: 18px;
      line-height: 1.7;
      padding: 0 20px 50px;
      background-color: #fdfdfd;
      color: #1a1a1a;
    }

    @media (prefers-color-scheme: dark) {
      body {
        background-color: #121212;
        color: #e0e0e0;
      }

      a {
        color: #90caf9;
      }
    }

    h1 {
      text-align: center;
      font-size: 1.8em;
      margin-bottom: 0.2em;
    }

    h2 {
      text-align: center;
      font-size: 1.1em;
      font-weight: normal;
      margin-top: -0.5em;
      margin-bottom: 1.5em;
      color: #666;
    }

    input[type="text"] {
      width: 100%;
      max-width: 600px;
      padding: 12px;
      display: block;
      margin: 0 auto 20px auto;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 1em;
      box-sizing: border-box;
    }

    input[type="text"]:focus {
      outline: none;
      border-color: #000;
      box-shadow: 0 0 0 3px rgba(0,0,0,0.1);
    }

    .button-container {
      display: flex;
      justify-content: center;
      gap: 10px;
      margin-bottom: 20px;
    }

    .action-button {
      padding: 10px 20px;
      font-size: 1em;
      border-radius: 4px;
      cursor: pointer;
      border: 1px solid #000;
      background-color: #000;
      color: white;
      min-width: 120px;
      transition: background-color 0.2s ease-in-out;
    }

    .action-button:hover {
      background-color: #444;
    }

    #resultsCount {
      text-align: center;
      font-weight: bold;
      margin-bottom: 20px;
      display: none;
    }

    .no-results {
      text-align: center;
      color: #666;
      font-style: italic;
      display: none;
      margin-top: 40px;
    }

    #bookGridContainer {
      display: grid;
      grid-template-columns: 1fr;
      gap: 20px;
    }

    .book-card {
      border: 1px solid #ccc;
      border-radius: 8px;
      padding: 15px;
      background-color: #fff;
    }

    .book-card-item {
      margin-bottom: 5px;
    }

    .book-card-item b {
      display: inline;
      font-weight: bold;
    }

    .buy-button {
      display: inline-block;
      margin-top: 10px;
      background-color: #000;
      color: #fff;
      padding: 8px 12px;
      border-radius: 4px;
      text-decoration: none;
      font-weight: bold;
    }

    .buy-button:hover {
      background-color: #444;
    }

    @media (prefers-color-scheme: dark) {
      .book-card {
        background-color: #1c1c1c;
        border-color: #444;
      }

      .buy-button {
        background-color: #fff;
        color: #000;
      }

      .buy-button:hover {
        background-color: #ccc;
      }
    }
  </style>
</head>

<body>
  <h1>Acervo do <a href="https://sebomenostelas.com.br">Sebo Menos Telas</a></h1>
  
  <input type="text" id="searchInput" onkeydown="handleKeyPress(event)" placeholder="Digite Título, Autor, Editora, etc.">

  <div class="button-container">
    <button onclick="filterContent()" class="action-button">Garimpar</button>
    <button onclick="clearSearch()" class="action-button">Limpar</button>
  </div>

  <div id="resultsCount"></div>
  <div id="bookGridContainer"></div>
  <div id="noResultsMessage" class="no-results">Nenhum livro encontrado.</div>

  <script>
    let allBooks = [];

    window.onload = function () {
      loadTsvData();
    };

    async function loadTsvData() {
      try {
        const response = await fetch('livros.tsv');
        if (!response.ok) throw new Error(`Erro HTTP: ${response.status}`);
        const tsv = await response.text();
        parseTsvContent(tsv);
      } catch (error) {
        document.getElementById("bookGridContainer").innerHTML = '<p>Erro ao carregar acervo.</p>';
        document.getElementById("noResultsMessage").style.display = 'none';
        document.getElementById("resultsCount").style.display = 'none';
        console.error(error);
      }
    }

    function parseTsvContent(tsv) {
      const lines = tsv.split('\n').filter(line => line.trim());
      const headers = lines[0].split('\t');

      const precoIndex = headers.findIndex(h => h.toLowerCase().includes('preço'));
      const freteIndex = headers.findIndex(h => h.toLowerCase().includes('frete'));
      const totalIndex = headers.findIndex(h => h.toLowerCase().includes('total'));
      const titleIndex = headers.findIndex(h => h.toLowerCase().includes('título'));
      const authorIndex = headers.findIndex(h => h.toLowerCase().includes('autor'));

      for (let i = 1; i < lines.length; i++) {
        const cells = lines[i].split('\t');
        if (cells.length !== headers.length) continue;

        let html = '';
        for (let j = 0; j < cells.length; j++) {
          const label = headers[j].trim();
          let value = cells[j].trim();

          if ([precoIndex, freteIndex, totalIndex].includes(j)) {
            const num = parseFloat(value.replace(',', '.'));
            if (!isNaN(num)) value = num.toFixed(2).replace('.', ',');
          }

          if (label.toLowerCase().includes('comprar')) {
            let link = '#';
            if (titleIndex > -1 && authorIndex > -1) {
              const msg = `Oi! Quero comprar o livro ${cells[titleIndex]} de ${cells[authorIndex]}`;
              link = `https://wa.me/5511981350566?text=${encodeURIComponent(msg)}`;
            }
            html += `<div class="book-card-item"><a href="${link}" class="buy-button" target="_blank">Comprar</a></div>`;
          } else {
            html += `<div class="book-card-item"><b>${label}:</b> ${value}</div>`;
          }
        }

        allBooks.push({
          html: `<div class="book-card">${html}</div>`,
          text: cells.join(' ').toUpperCase()
        });
      }
    }

    function filterContent() {
      const input = document.getElementById("searchInput").value.trim().toUpperCase();
      let resultHtml = '';
      let count = 0;

      for (const book of allBooks) {
        if (book.text.includes(input)) {
          resultHtml += book.html;
          count++;
        }
      }

      document.getElementById("bookGridContainer").innerHTML = resultHtml;
      document.getElementById("resultsCount").textContent = count > 0 ? `Foram encontrados ${count} livro(s).` : '';
      document.getElementById("resultsCount").style.display = count > 0 ? 'block' : 'none';
      document.getElementById("noResultsMessage").style.display = count === 0 ? 'block' : 'none';
    }

    function handleKeyPress(e) {
      if (e.key === 'Enter') filterContent();
    }

    function clearSearch() {
      document.getElementById("searchInput").value = '';
      document.getElementById("bookGridContainer").innerHTML = '';
      document.getElementById("resultsCount").style.display = 'none';
      document.getElementById("noResultsMessage").style.display = 'none';
    }
  </script>
</body>
</html>

